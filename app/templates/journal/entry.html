{% extends "base.html" %}

{% block title %}Analyse Your Day - MindNest{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-10 col-lg-8">
            
            <div class="text-center mb-5">
                <h1 class="fw-bold display-6">Reflect & Discover</h1>
                <p class="text-muted">Type your heart out. Let's find the patterns in your day together.</p>
            </div>

            <div class="row g-4">
                <div class="col-md-6">
                    <div class="card border-0 shadow-sm rounded-4 h-100">
                        <div class="card-body p-4">
                            <form id="analysisForm">
                                <label for="dayReflection" class="form-label fw-bold text-secondary mb-3">Today's Narrative</label>
                                <textarea 
                                    name="user_input" 
                                    id="dayReflection" 
                                    class="form-control border-0 bg-light p-3" 
                                    rows="10" 
                                    placeholder="Write about your highlights, challenges, or just small moments..."
                                    style="resize: none; border-radius: 12px;"
                                    required></textarea>

                                <div class="d-grid mt-4">
                                    <button type="submit" class="btn btn-primary btn-lg fw-bold rounded-pill py-3 shadow-sm transition-hover" id="analyzeBtn">
                                        <span id="btnText">âœ¨ Analyse My Day</span>
                                        <span id="btnLoader" class="spinner-border spinner-border-sm d-none" role="status"></span>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <div class="col-md-6">
                    <div id="resultPlaceholder" class="h-100 d-flex flex-column align-items-center justify-content-center bg-white rounded-4 border border-dashed text-center p-5">
                        <div class="mb-3 opacity-25">
                            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" fill="currentColor" class="bi bi-stars" viewBox="0 0 16 16">
                                <path d="M7.657 6.247c.11-.33.576-.33.686 0l.645 1.937a2.89 2.89 0 0 0 1.829 1.828l1.936.645c.33.11.33.576 0 .686l-1.937.645a2.89 2.89 0 0 0-1.828 1.829l-.645 1.936c-.11.33-.576.33-.686 0l-.645-1.937a2.89 2.89 0 0 0-1.828-1.828l-1.937-.645c-.33-.11-.33-.576 0-.686l1.937-.645a2.89 2.89 0 0 0 1.828-1.828zM3.794 1.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a2.17 2.17 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A2.17 2.17 0 0 0 2.21 3.794l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387c.518-.173.924-.579 1.097-1.097zM12.467 1.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a2.17 2.17 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162a2.17 2.17 0 0 0-1.097-1.097l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387c.518-.173.924-.579 1.097-1.097z"/>
                            </svg>
                        </div>
                        <h5 class="fw-bold text-muted">Your Analysis will appear here</h5>
                        <p class="small text-secondary px-4">Once you submit, we'll process your entry for mood and key insights.</p>
                    </div>

                    <div id="analysisResult" class="card border-0 shadow-sm rounded-4 h-100 d-none animate-fade-in">
                <div class="card-body p-4">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h4 class="fw-bold mb-0">Analysis Result</h4>
                        <span id="moodBadge" class="badge bg-primary text-white rounded-pill px-3">Calm (8/10)</span>
                    </div>
                    
                    <div class="mb-4">
                        <label class="small text-muted text-uppercase fw-bold">Empathetic Reflection</label>
                        <p id="summaryText" class="mt-2 text-dark fs-6 lh-base">
                            </p>
                    </div>

                    <div class="row g-2 mt-auto">
                        <div class="col-6">
                            <div class="p-3 bg-light rounded-3">
                                <small class="text-muted d-block">Overall Sentiment</small>
                                <strong id="keyEmotion" class="text-capitalize"></strong>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="p-3 bg-light rounded-3">
                                <small class="text-muted d-block">Personalized Advice</small>
                                <strong id="suggestedFocus" class="text-primary small"></strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
                </div>
            </div>

        </div>
    </div>
</div>

<style>
    /* Styling for the soft badge */
    .bg-success-soft { background-color: rgba(25, 135, 84, 0.1); }
    
    /* Animation for the analysis card appearing */
    .animate-fade-in {
        animation: fadeIn 0.6s ease-out forwards;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .transition-hover:hover {
        transform: translateY(-2px);
    }
</style>

<script src="{{url_for('static', filename='js/journal.js')}}"></script>
{% endblock %}